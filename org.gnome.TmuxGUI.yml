app-id: org.gnome.TmuxGUI
runtime: org.gnome.Platform
runtime-version: '49'
sdk: org.gnome.Sdk
command: tmuxgui

finish-args:
  # Display
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --device=dri
  # Home directory access
  - --filesystem=home
  # Tmp for tmux sockets
  - --filesystem=/tmp
  # Talk to host for tmux
  - --talk-name=org.freedesktop.Flatpak

modules:
  # tmux (include in flatpak)
  - name: libevent
    buildsystem: autotools
    sources:
      - type: archive
        url: https://github.com/libevent/libevent/releases/download/release-2.1.12-stable/libevent-2.1.12-stable.tar.gz
        sha256: 92e6de1be9ec176428fd2367677e61ceffc2ee1cb119035037a27d346b0403bb

  - name: tmux
    buildsystem: autotools
    sources:
      - type: archive
        url: https://github.com/tmux/tmux/releases/download/3.4/tmux-3.4.tar.gz
        sha256: 551ab8dea0bf505c0ad6b7bb35ef567cdde0ccb84357df142c254f35a23e19aa

  # Main application
  - name: tmuxgui
    buildsystem: simple
    build-commands:
      - mkdir -p /app/share/tmuxgui
      - cp -r src/gnome_tmux /app/share/tmuxgui/
      - cp run.py /app/share/tmuxgui/
      - install -Dm755 tmuxgui.sh /app/bin/tmuxgui
      - install -Dm644 data/org.gnome.TmuxGUI.desktop /app/share/applications/org.gnome.TmuxGUI.desktop
      - install -Dm644 data/org.gnome.TmuxGUI.metainfo.xml /app/share/metainfo/org.gnome.TmuxGUI.metainfo.xml
      - install -Dm644 data/org.gnome.TmuxGUI.svg /app/share/icons/hicolor/scalable/apps/org.gnome.TmuxGUI.svg
    sources:
      - type: dir
        path: .
